# LitterBox Configuration File
# Generated by Ansible

server:
  host: {{ ludus_litterbox_host }}
  port: {{ ludus_litterbox_port }}
  debug: {{ ludus_litterbox_debug | lower }}
  workers: {{ ludus_litterbox_workers | default(4) }}

analysis:
  timeout: {{ ludus_litterbox_analysis_timeout | default(300) }}
  max_file_size: {{ ludus_litterbox_max_file_size | default(104857600) }}  # 100MB
  allowed_extensions:
{% for ext in ludus_litterbox_allowed_extensions | default(['exe', 'dll', 'sys', 'scr', 'com', 'bat', 'ps1', 'vbs', 'js', 'doc', 'docx', 'xls', 'xlsx', 'ppt', 'pptx', 'pdf', 'lnk']) %}
    - {{ ext }}
{% endfor %}

paths:
  uploads: "{{ ludus_litterbox_install_dir }}\\LitterBox\\uploads"
  results: "{{ ludus_litterbox_install_dir }}\\LitterBox\\results"
  temp: "{{ ludus_litterbox_install_dir }}\\LitterBox\\temp"
  tools: "{{ ludus_litterbox_install_dir }}\\LitterBox\\tools"

security:
  enable_auth: {{ ludus_litterbox_enable_auth | default(false) | lower }}
  api_key: "{{ ludus_litterbox_api_key | default('') }}"
  allowed_ips:
{% if ludus_litterbox_allowed_ips is defined %}
{% for ip in ludus_litterbox_allowed_ips %}
    - {{ ip }}
{% endfor %}
{% else %}
    - 127.0.0.1
    - ::1
{% endif %}

features:
  static_analysis: {{ ludus_litterbox_enable_static | default(true) | lower }}
  dynamic_analysis: {{ ludus_litterbox_enable_dynamic | default(true) | lower }}
  holygrail: {{ ludus_litterbox_enable_holygrail | default(true) | lower }}
  doppelganger: {{ ludus_litterbox_enable_doppelganger | default(true) | lower }}
  yara_rules: {{ ludus_litterbox_enable_yara | default(true) | lower }}
  
logging:
  level: "{{ ludus_litterbox_log_level | default('INFO') }}"
  file: "{{ ludus_litterbox_install_dir }}\\LitterBox\\logs\\litterbox.log"
  max_size: {{ ludus_litterbox_log_max_size | default(10485760) }}  # 10MB
  backup_count: {{ ludus_litterbox_log_backup_count | default(5) }}

database:
  type: "{{ ludus_litterbox_db_type | default('sqlite') }}"
  path: "{{ ludus_litterbox_install_dir }}\\LitterBox\\database\\litterbox.db"

# Advanced settings
advanced:
  process_monitor_interval: {{ ludus_litterbox_process_monitor_interval | default(5) }}
  memory_scan_interval: {{ ludus_litterbox_memory_scan_interval | default(10) }}
  cleanup_old_results_days: {{ ludus_litterbox_cleanup_days | default(30) }}
  enable_telemetry: {{ ludus_litterbox_enable_telemetry | default(false) | lower }}
